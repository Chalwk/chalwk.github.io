<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Autism Symptom & Emotion Tracker</title>
    <link rel="stylesheet" href="style.css" />
    <meta name="description" content="Comprehensive autism symptom and emotion tracker with coping strategies, pattern recognition, and data visualization." />
</head>
<body>
<a class="skip" href="#app">Skip to main content</a>
<header class="site-header">
    <div class="container header-row">
        <div>
            <h1>Autism Symptom & Emotion Tracker</h1>
            <p class="tagline">Track your feelings, identify patterns, and get personalized coping strategies.</p>
        </div>
        <div class="header-actions">
            <button id="open-settings" class="btn" aria-haspopup="true">Settings</button>
            <button id="help-btn" class="btn">Help</button>
        </div>
    </div>
</header>

<main class="container main-grid" id="app" role="main">
    <section class="panel" id="emotion-panel" aria-labelledby="emotion-heading">
        <h2 id="emotion-heading">How are you feeling?</h2>
        <div class="emotion-wheel-container">
            <div id="emotion-wheel" class="emotion-wheel">
                <!-- Emotion wheel will be generated by JavaScript -->
            </div>
            <div class="emotion-controls">
                <button id="reset-wheel" class="btn">Reset Selection</button>
                <div id="selected-emotions" class="selected-emotions"></div>
            </div>
        </div>
    </section>

    <section class="panel" id="symptom-panel" aria-labelledby="symptom-heading">
        <h2 id="symptom-heading">Physical & Mental Symptoms</h2>

        <div class="controls-row" aria-hidden="false">
            <input id="search" placeholder="Filter symptoms (type to search)" aria-label="Filter symptoms" />
            <button id="clear-btn" class="btn" title="Clear">Clear</button>
        </div>

        <form id="symptom-form" aria-describedby="symptom-help">
            <p id="symptom-help" class="muted">Select items that match how you feel. Each selected item can have an intensity from low to high.</p>
            <div id="symptom-list" class="symptom-list" role="group" aria-live="polite"></div>

            <div class="actions-row">
                <button type="button" id="analyze-btn" class="btn primary">Analyze</button>
                <button type="button" id="save-btn" class="btn" title="Save entry to local history">Save entry</button>
            </div>
        </form>
    </section>

    <section class="panel" id="result-panel" aria-labelledby="results-heading">
        <h2 id="results-heading">Suggestions & Insights</h2>
        <div id="result-summary" class="result-summary muted">No analysis yet. Pick symptoms and press Analyze.</div>

        <div id="suggestions" class="suggestions" aria-live="polite"></div>

        <div class="pattern-insights">
            <h3>Pattern Recognition</h3>
            <div id="pattern-insights" class="pattern-insights-content">
                <p class="muted">Pattern insights will appear here after multiple entries.</p>
            </div>
        </div>

        <details class="notes" id="explain-details">
            <summary>How this works</summary>
            <p>This app uses a weighted rule-matching system. Each checkbox and emotion maps to tags like "sensory" or "fatigue". Selected items can have an intensity that increases their weight. Tags with higher total weight surface first. This is not medical advice. If you are in crisis, contact local emergency services or a trusted professional.</p>
        </details>
    </section>

    <section class="panel" id="history-panel" aria-labelledby="history-heading">
        <h2 id="history-heading">History & Patterns</h2>
        <p class="muted">Saved entries are stored locally in your browser only. You can export JSON or CSV for backups.</p>

        <div class="export-actions">
            <button id="export-csv-btn" class="btn" title="Export history as CSV">Export CSV</button>
            <button id="export-json-btn" class="btn" title="Export as JSON">Export JSON</button>
            <button id="import-json-btn" class="btn" title="Import JSON backup">Import JSON</button>
        </div>

        <div id="history-list" class="history-list" aria-live="polite"></div>

        <div class="history-actions">
            <button id="clear-history" class="btn" title="Remove all saved entries">Clear All</button>
        </div>

        <div class="chart-wrap">
            <h3>Tag frequency (history)</h3>
            <canvas id="tag-chart" width="400" height="160" aria-label="Tag frequency chart"></canvas>
        </div>

        <div class="chart-wrap">
            <h3>Emotion patterns</h3>
            <canvas id="emotion-chart" width="400" height="160" aria-label="Emotion frequency chart"></canvas>
        </div>
    </section>
</main>

<footer class="site-footer">
    <div class="container">
        <small>Â© Autism Symptom Tracker - Jericho Crosby (Chalwk). Not medical advice.</small>
    </div>
</footer>

<!-- Settings / Help modals (simple in-page) -->
<dialog id="settings-dialog" aria-labelledby="settings-title">
    <form method="dialog" class="dialog-form">
        <h3 id="settings-title">Settings</h3>
        <label>
            Max history entries
            <input id="max-history" type="number" min="5" max="1000" />
        </label>
        <label>
            <input id="enable-notifications" type="checkbox" />
            Enable reminder notifications
        </label>
        <label>
            <input id="enable-sounds" type="checkbox" />
            Enable interface sounds
        </label>
        <div class="muted" style="margin-top:8px">Data remains local. Use Export to back up. Import will merge entries.</div>
        <menu class="dialog-actions">
            <button id="save-settings" class="btn primary">Save</button>
            <button id="close-settings" class="btn">Close</button>
        </menu>
    </form>
</dialog>

<dialog id="help-dialog" aria-labelledby="help-title">
    <form method="dialog" class="dialog-form">
        <h3 id="help-title">Quick help</h3>
        <p class="muted">Select emotions and symptoms that match how you feel. Set intensity if needed. Analyze first to see suggestions, then Save to keep an entry. Export frequently if you want backups.</p>
        <menu class="dialog-actions">
            <button id="close-help" class="btn">Close</button>
        </menu>
    </form>
</dialog>

<input id="file-input" type="file" accept="application/json" style="display:none" />

<script src="script.js" defer></script>
</body>
</html>